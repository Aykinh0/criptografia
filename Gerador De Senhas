    def executar_sistema():
        while True:
            print("\n" + "=" * 60)
            print("ğŸ”  BEM-VINDO AO SISTEMA DE CRIPTOGRAFIA  ğŸ”".center(60))
            print("=" * 60)
            print("Este sistema permite que vocÃª proteja ou revele mensagens usando".center(60))
            print("criptografia segura com geraÃ§Ã£o automÃ¡tica de chaves.".center(60))
            print("-" * 60)
            print("1ï¸âƒ£  Criptografar uma nova mensagem".ljust(60))
            print("2ï¸âƒ£  Descriptografar uma mensagem existente".ljust(60))
            print("3ï¸âƒ£  Encerrar o programa".ljust(60))
            print("-" * 60)

            try:
                dados_usuario = int(input("\nğŸ“˜ Escolha o que deseja fazer:\n"
                "1ï¸âƒ£  Criptografar uma nova mensagem\n"
                "2ï¸âƒ£  Descriptografar uma mensagem existente\n"
                "Digite o nÃºmero da opÃ§Ã£o desejada: "))

                if dados_usuario == 1:
                    mensagem = input("\nğŸ’¬ Digite a mensagem que deseja criptografar (texto ou senha): ")
                    senha_acesso_user = int(input('\nğŸ” Defina o tamanho da sua senha de acesso (mÃ­nimo recomendado: 8 caracteres): '))

                    if senha_acesso_user <= 7:
                        print('Insira um valor vÃ¡lido')
                        return None

                    chave_codificada, chave_acesso_codificada, senha_acesso_user = chave_codificada_funcao(mensagem, senha_acesso_user)

                    with open(nome_arquivo, mode="a", newline="", encoding='utf-8') as arquivo_csv:
                        escritor = csv.writer(arquivo_csv, delimiter=';')
                        escritor.writerow([chave_codificada, chave_acesso_codificada, senha_acesso_user])

                    #chave_acesso_codificada Ã© a mensagem criptografada
                    print(f'\nğŸ”‘ Chave gerada: {chave_codificada}')
                    print(f"ğŸ§© Mensagem criptografada: {chave_acesso_codificada}")
                    print(f"ğŸ”’ Senha de acesso: {senha_acesso_user}")
                    print("Guarde-a com seguranÃ§a â€” ela serÃ¡ necessÃ¡ria para descriptografar sua mensagem!\n")

                elif dados_usuario == 2:
                    chave_codificada_entrada = input("\nğŸ—ï¸  Digite a *chave de acesso* gerada durante a criptografia: ")
                    mensagem_codificada_entrada = input("ğŸ“© Agora digite a *mensagem codificada* (aquela sequÃªncia longa que o sistema mostrou): ")
                    senha_entrada = input("insira a senha: ")
                    with open(nome_arquivo, mode="r", newline="", encoding='utf-8') as arquivo_csv:
                        leitor = csv.reader(arquivo_csv, delimiter=';')
                        encontrado = False
                        for linha in leitor:
                            # garantia de que a linha tem 3 colunas e sem espaÃ§os estranhos
                            if len(linha) < 3:
                                continue
                            chave_salva = linha[0].strip()
                            mensagem_salva = linha[1].strip()
                            senha_salva = linha[2].strip()

                            # ConferÃªncia correta: compara chave, mensagem e senha como strings
                            if chave_salva == chave_codificada_entrada and mensagem_salva == mensagem_codificada_entrada and senha_salva == senha_entrada:
                                try:
                                    mensagem_decodificada_funcao(mensagem_salva, chave_salva, senha_entrada)
                                    encontrado = True
                                except Exception as e:
                                    print(
                                        "\nâŒ Erro ao descriptografar. Verifique se a chave e a mensagem correspondem.")
                                    # opcional: mostrar erro tÃ©cnico para debug
                                    # print("Detalhe do erro:", e)
                                break

                        if not encontrado:
                            print(
                                "\nâŒ Chave, mensagem ou senha nÃ£o conferem. Verifique suas informaÃ§Ãµes e tente novamente.")

                elif dados_usuario == 3:
                    print('Programa encerrado')
                    print('-' * 32)
                    break

                else:
                    print("Programa sem respostas inesperado")

            except ValueError:
                print('Erro nÃ£o identificado')

    if __name__ == '__main__':
        executar_sistema()
